import{j as e}from"./index-DbrkFvWc.js";import{r as a}from"./router-DJX9oSP-.js";import{a as s}from"./axios-rSMZb3Ae.js";import"./react-CMmhtoO5.js";function l(){const[l,t]=a.useState([]),[r,i]=a.useState(!0),[n,c]=a.useState(null),[d,o]=a.useState(!1),[h,m]=a.useState(null),[u,x]=a.useState(""),[j,v]=a.useState("all");a.useEffect((()=>{p()}),[]);const p=async()=>{try{i(!0);const e=localStorage.getItem("token");if(!e)return c("Authentication required"),void i(!1);const a=await s.get("http://localhost:5000/api/admin/users",{headers:{Authorization:`Bearer ${e}`}});t(a.data),i(!1)}catch(e){c("Failed to fetch users. Please try again."),i(!1)}},N=l.filter((e=>{const a=e.name.toLowerCase().includes(u.toLowerCase())||e.email.toLowerCase().includes(u.toLowerCase());return"all"===j?a:"active"===j?a&&e.active:"inactive"===j?a&&!e.active:"admin"===j?a&&"admin"===e.role:"vendor"===j?a&&"vendor"===e.role:"user"===j?a&&"user"===e.role:a}));return r?e.jsx("div",{className:"loading-spinner",children:e.jsx("div",{className:"spinner"})}):n?e.jsx("div",{className:"error-container",children:e.jsxs("div",{className:"error-box",children:[e.jsx("h2",{className:"error-title",children:"Error"}),e.jsx("p",{className:"error-message",children:n}),e.jsx("button",{onClick:()=>window.location.reload(),className:"retry-button",children:"Try Again"})]})}):e.jsx("div",{className:"manage-users-container",children:e.jsxs("div",{className:"manage-users-wrapper",children:[e.jsxs("div",{className:"manage-users-header",children:[e.jsx("h1",{className:"manage-users-title",children:"Manage Users"}),e.jsx("p",{className:"manage-users-subtitle",children:"View and manage all users in the system"})]}),e.jsx("div",{className:"filters-container",children:e.jsxs("div",{className:"filters-grid",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"search-container",children:[e.jsx("div",{className:"search-icon",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{type:"text",id:"search",className:"search-input",placeholder:"Search users by name or email",value:u,onChange:e=>x(e.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter",className:"sr-only",children:"Filter"}),e.jsxs("select",{id:"filter",className:"filter-select",value:j,onChange:e=>v(e.target.value),children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"vendor",children:"Vendors"}),e.jsx("option",{value:"user",children:"Regular Users"})]})]})]})}),e.jsx("div",{className:"table-container",children:e.jsx("div",{className:"table-scroll",children:e.jsxs("table",{className:"users-table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{style:{textAlign:"right"},children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:N.length>0?N.map((a=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"user-cell",children:[e.jsx("div",{className:"user-avatar",children:a.profileImage?e.jsx("img",{src:`http://localhost:5000/uploads/${a.profileImage}`,alt:a.name}):e.jsx("div",{className:"avatar-placeholder",children:a.name.charAt(0).toUpperCase()})}),e.jsx("div",{className:"user-info",children:e.jsx("div",{className:"user-name",children:a.name})})]})}),e.jsx("td",{children:e.jsx("div",{className:"user-email",children:a.email})}),e.jsx("td",{children:e.jsx("span",{className:"badge "+("admin"===a.role?"badge-admin":"vendor"===a.role?"badge-vendor":"badge-user"),children:a.role.charAt(0).toUpperCase()+a.role.slice(1)})}),e.jsx("td",{children:e.jsx("span",{className:"badge "+(a.active?"badge-active":"badge-inactive"),children:a.active?"Active":"Inactive"})}),e.jsx("td",{className:"date-cell",children:new Date(a.createdAt).toLocaleDateString()}),e.jsx("td",{className:"actions-cell",children:h===a._id?e.jsxs("div",{className:"action-buttons",children:[e.jsxs("select",{className:"role-select",defaultValue:a.role,onChange:e=>(async(e,a)=>{try{o(!0);const r=localStorage.getItem("token");await s.put(`http://localhost:5000/api/admin/users/${e}/role`,{role:a},{headers:{Authorization:`Bearer ${r}`}}),t(l.map((s=>s._id===e?{...s,role:a}:s))),o(!1),m(null)}catch(r){o(!1)}})(a._id,e.target.value),disabled:d,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"vendor",children:"Vendor"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsx("button",{onClick:()=>m(null),className:"cancel-button",disabled:d,children:"Cancel"})]}):e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{onClick:()=>m(a._id),className:"edit-button",disabled:d,children:"Edit"}),e.jsx("button",{onClick:()=>(async(e,a)=>{try{o(!0);const r=localStorage.getItem("token");await s.put(`http://localhost:5000/api/admin/users/${e}/status`,{active:a},{headers:{Authorization:`Bearer ${r}`}}),t(l.map((s=>s._id===e?{...s,active:a}:s))),o(!1)}catch(r){o(!1)}})(a._id,!a.active),className:a.active?"deactivate-button":"activate-button",disabled:d,children:a.active?"Deactivate":"Activate"})]})})]},a._id))):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"empty-message",children:"No users found matching your search."})})})]})})})]})})}export{l as default};
