import{a as e,b as a,c as s,q as i,o as n,k as t,g as l,j as c,w as r,v as d,C as o,D as m,E as h,F as u,p,f as x,G as g,d as j}from"./index-CGBRwBly.js";import{r as v,L as N,b as f,u as b}from"./router-CbvfO1vz.js";import{k,s as y,t as w,c as P,l as C,o as S,q as F,u as I,v as D}from"./index-Crxxp2-0.js";import"./react-CMmhtoO5.js";import"./iconBase-YQ9d7kAD.js";const A=()=>{const[o,m]=v.useState([]),[h,u]=v.useState(!0),[p,x]=v.useState(null),[g,j]=v.useState({show:!1,packageId:null});v.useEffect((()=>{f()}),[]);const f=async()=>{try{u(!0),x(null);const c=e.currentUser;if(!c)return x("Authentication required"),void u(!1);const r=a(s,"tourPackages"),d=i(r,n("vendorId"),t(c.uid)),o=await l(d);if(!o.exists())return m([]),void u(!1);const h=[];o.forEach((e=>{h.push({id:e.key,...e.val()})})),m(h)}catch(c){x("Failed to fetch packages. Please try again.")}finally{u(!1)}};return h?c.jsxs("div",{className:"packages-loading",children:[c.jsx("div",{className:"loading-spinner"}),c.jsx("p",{children:"Loading packages..."})]}):p?c.jsxs("div",{className:"packages-error",children:[c.jsx(k,{className:"error-icon"}),c.jsx("p",{children:p})]}):0===o.length?c.jsxs("div",{className:"no-packages",children:[c.jsx(y,{className:"empty-icon"}),c.jsx("p",{children:"You haven't added any tour packages yet."}),c.jsx(N,{to:"/vendor/add-package",className:"add-package-button",children:"Add Your First Package"})]}):c.jsxs("div",{className:"vendor-packages",children:[c.jsxs("div",{className:"packages-header",children:[c.jsx("h2",{children:"Your Tour Packages"}),c.jsx("p",{children:"Manage your tour packages and view their performance"})]}),c.jsx("div",{className:"packages-grid",children:o.map((i=>c.jsxs("div",{className:"package-card",children:[c.jsxs("div",{className:"package-image",children:[c.jsx("img",{src:i.images&&i.images.length>0?i.images[0]:"https://source.unsplash.com/random/600x400/?travel,"+Math.random(),alt:i.title,loading:"lazy",onError:e=>{e.target.onerror=null,e.target.src="https://source.unsplash.com/random/600x400/?vacation"}}),c.jsx("span",{className:"package-status "+(i.available?"active":"inactive"),children:i.available?"Active":"Inactive"}),c.jsxs("div",{className:"package-rating",children:[c.jsx("span",{className:"stars",children:"★★★★★"}),c.jsx("span",{className:"rating-number",children:"4.8"})]})]}),c.jsxs("div",{className:"package-content",children:[c.jsx("h3",{children:i.title}),c.jsxs("p",{className:"package-destination",children:[c.jsx(w,{})," ",i.destination," • ",i.duration]}),c.jsxs("p",{className:"package-price",children:["₹",i.price?i.price.toLocaleString("en-IN"):"0"," ",c.jsx("span",{className:"per-person",children:"/ person"})]}),c.jsxs("div",{className:"package-features",children:[c.jsxs("span",{children:[c.jsx(P,{})," ",i.maxGroupSize||"12"," People"]}),c.jsxs("span",{children:[c.jsx(C,{})," ",i.duration||"7 Days"]})]}),c.jsxs("div",{className:"package-actions",children:[c.jsx("button",{className:"status-toggle "+(i.available?"deactivate":"activate"),onClick:()=>(async(i,n)=>{try{if(!e.currentUser)return;const t=a(s,`tourPackages/${i}`);await r(t,{available:!n}),m(o.map((e=>e.id===i?{...e,available:!n}:e)))}catch(t){alert("Failed to update package status")}})(i.id,i.available),children:i.available?"Deactivate":"Activate"}),c.jsxs(N,{to:`/packages/${i.id}`,className:"view-button",children:[c.jsx(y,{})," View"]}),c.jsxs(N,{to:`/vendor/edit-package/${i.id}`,className:"edit-button",children:[c.jsx(S,{})," Edit"]}),c.jsxs("button",{className:"delete-button",onClick:()=>j({show:!0,packageId:i.id}),children:[c.jsx(F,{})," Delete"]})]})]})]},i.id)))}),g.show&&c.jsx("div",{className:"delete-modal",children:c.jsxs("div",{className:"modal-content",children:[c.jsx("div",{className:"modal-icon",children:c.jsx(k,{})}),c.jsx("h3",{children:"Delete Package"}),c.jsx("p",{children:"Are you sure you want to delete this package? This action cannot be undone and all package data will be permanently removed."}),c.jsxs("div",{className:"modal-actions",children:[c.jsxs("button",{className:"cancel-button",onClick:()=>j({show:!1,packageId:null}),children:[c.jsx(F,{})," Cancel"]}),c.jsxs("button",{className:"confirm-button",onClick:async()=>{if(g.packageId)try{if(!e.currentUser)return;const i=a(s,`tourPackages/${g.packageId}`);await d(i),m(o.filter((e=>e.id!==g.packageId))),j({show:!1,packageId:null})}catch(i){alert("Failed to delete package")}},children:[c.jsx(I,{})," Delete Package"]})]})]})})]})},$=()=>{const[i,n]=v.useState([]),[t,d]=v.useState(!0),[o,m]=v.useState(null),[h,u]=v.useState("all"),[p,x]=v.useState({});v.useEffect((()=>{g()}),[]);const g=async()=>{try{d(!0),m(null);const i=e.currentUser;if(!i)return m("Authentication required"),void d(!1);const t=a(s,"bookings"),c=await l(t);if(!c.exists())return n([]),void d(!1);const r=[];c.forEach((e=>{const a={id:e.key,...e.val()};a.vendorId===i.uid&&r.push(a)})),n(r);const o=[...new Set(r.map((e=>e.packageId)))];await j(o)}catch(i){m("Failed to fetch bookings. Please try again.")}finally{d(!1)}},j=async e=>{try{const i={};for(const n of e){const e=a(s,`tourPackages/${n}`),t=await l(e);t.exists()?i[n]=t.val().title:i[n]="Unknown Package"}x(i)}catch(i){}},N=async(t,l)=>{try{if(!e.currentUser)return;const c=a(s,`bookings/${t}`);await r(c,{status:l,updatedAt:Date.now()}),n(i.map((e=>e.id===t?{...e,status:l}:e)))}catch(c){alert("Failed to update booking status")}},f="all"===h?i:i.filter((e=>e.status===h));return t?c.jsxs("div",{className:"bookings-loading",children:[c.jsx("div",{className:"spinner"}),c.jsx("p",{children:"Loading bookings..."})]}):o?c.jsx("div",{className:"bookings-error",children:o}):c.jsxs("div",{className:"vendor-bookings",children:[c.jsx("h2",{children:"Manage Bookings"}),c.jsxs("div",{className:"booking-filters",children:[c.jsx("button",{className:"filter-button "+("all"===h?"active":""),onClick:()=>u("all"),children:"All"}),c.jsx("button",{className:"filter-button "+("pending"===h?"active":""),onClick:()=>u("pending"),children:"Pending"}),c.jsx("button",{className:"filter-button "+("confirmed"===h?"active":""),onClick:()=>u("confirmed"),children:"Confirmed"}),c.jsx("button",{className:"filter-button "+("completed"===h?"active":""),onClick:()=>u("completed"),children:"Completed"}),c.jsx("button",{className:"filter-button "+("cancelled"===h?"active":""),onClick:()=>u("cancelled"),children:"Cancelled"})]}),0===f.length?c.jsxs("div",{className:"no-bookings",children:[c.jsxs("p",{children:["No ","all"!==h?h:""," bookings found."]}),0===i.length&&c.jsx("p",{children:"When customers book your packages, they'll appear here."})]}):c.jsx("div",{className:"bookings-table",children:c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Booking ID"}),c.jsx("th",{children:"Package"}),c.jsx("th",{children:"Customer"}),c.jsx("th",{children:"Booking Date"}),c.jsx("th",{children:"Price"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Actions"})]})}),c.jsx("tbody",{children:f.map((e=>{var a,s;return c.jsxs("tr",{children:[c.jsx("td",{children:e.id.substring(0,8)}),c.jsx("td",{children:p[e.packageId]||"Unknown Package"}),c.jsx("td",{children:e.customerName||e.userName||"Unknown"}),c.jsx("td",{children:(s=e.bookingDate||e.createdAt,new Date(s).toLocaleDateString())}),c.jsxs("td",{children:["₹",(null==(a=e.price)?void 0:a.toLocaleString())||"N/A"]}),c.jsx("td",{children:c.jsx("span",{className:`status-badge ${e.status}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),c.jsx("td",{children:c.jsxs("div",{className:"booking-actions",children:["pending"===e.status&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"confirm-button",onClick:()=>N(e.id,"confirmed"),children:"Confirm"}),c.jsx("button",{className:"cancel-button",onClick:()=>N(e.id,"cancelled"),children:"Cancel"})]}),"confirmed"===e.status&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"complete-button",onClick:()=>N(e.id,"completed"),children:"Mark Complete"}),c.jsx("button",{className:"cancel-button",onClick:()=>N(e.id,"cancelled"),children:"Cancel"})]}),("completed"===e.status||"cancelled"===e.status)&&c.jsx("span",{children:"No actions available"})]})})]},e.id)}))})]})})]})},U=({vendorInfo:e})=>{const[i,n]=v.useState({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",companyName:(null==e?void 0:e.companyName)||"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[t,l]=v.useState(!1),[d,p]=v.useState(!1),[x,g]=v.useState(null),[j,N]=v.useState(null),[f,b]=v.useState(!1),[k,y]=v.useState((null==e?void 0:e.photoURL)||""),[w,P]=v.useState(!1),C=v.useRef(null),S=e=>{n({...i,[e.target.name]:e.target.value})};return c.jsxs("div",{className:"vendor-profile",children:[c.jsxs("div",{className:"profile-header",children:[c.jsx("div",{className:"profile-photo-container",children:c.jsxs("div",{className:"profile-photo",children:[k?c.jsx("img",{src:k,alt:"Profile"}):c.jsx("div",{className:"profile-photo-placeholder",children:i.name?i.name.charAt(0).toUpperCase():"U"}),t&&c.jsxs("div",{className:"photo-actions",children:[c.jsx("button",{type:"button",className:"upload-btn",onClick:()=>C.current.click(),disabled:w,children:w?"Uploading...":c.jsxs(c.Fragment,{children:[c.jsx(D,{})," Change Photo"]})}),k&&c.jsxs("button",{type:"button",className:"remove-btn",onClick:async()=>{try{if(P(!0),y(""),t&&e.uid){const i=a(s,`users/${e.uid}`);await r(i,{photoURL:""});const n=JSON.parse(localStorage.getItem("user"));n&&(n.photoURL="",localStorage.setItem("user",JSON.stringify(n)))}}catch(i){g("Failed to remove photo. Please try again.")}finally{P(!1)}},disabled:w,children:[c.jsx(F,{})," Remove"]}),c.jsx("input",{type:"file",ref:C,onChange:async i=>{const n=i.target.files[0];if(n)try{P(!0),g(null);const i=o(m,`profile_photos/${e.uid||"temp"}_${Date.now()}`),l=await h(i,n),c=await u(l.ref);if(y(c),t){const i=a(s,`users/${e.uid}`);await r(i,{photoURL:c});const n=JSON.parse(localStorage.getItem("user"));n&&(n.photoURL=c,localStorage.setItem("user",JSON.stringify(n)))}}catch(l){g("Failed to upload photo. Please try again.")}finally{P(!1)}},accept:"image/*",style:{display:"none"}})]})]})}),c.jsx("h2",{children:"Profile Information"})]}),x&&c.jsx("div",{className:"profile-error",children:x}),j&&c.jsx("div",{className:"profile-success",children:j}),c.jsxs("form",{onSubmit:async t=>{var c,d;t.preventDefault(),p(!0),g(null),N(null);try{const t=JSON.parse(localStorage.getItem("user"));if(!t||!t.uid)return g("Authentication required"),void p(!1);const c={name:i.name,companyName:i.companyName,phone:i.phone,address:i.address,updatedAt:Date.now()},d=a(s,`users/${t.uid}`);k&&k!==(null==e?void 0:e.photoURL)&&(c.photoURL=k),await r(d,c),N("Profile updated successfully");const o={...t,...c};localStorage.setItem("user",JSON.stringify(o)),f&&(n({...i,currentPassword:"",newPassword:"",confirmPassword:""}),b(!1)),l(!1)}catch(o){g((null==(d=null==(c=o.response)?void 0:c.data)?void 0:d.message)||"Failed to update profile. Please try again.")}finally{p(!1)}},className:"profile-form",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"name",children:"Full Name"}),c.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,disabled:!t,required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"email",children:"Email"}),c.jsx("input",{type:"email",id:"email",name:"email",value:i.email,disabled:!0,required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"companyName",children:"Company Name"}),c.jsx("input",{type:"text",id:"companyName",name:"companyName",value:i.companyName,onChange:S,disabled:!t,required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"phone",children:"Phone Number"}),c.jsx("input",{type:"tel",id:"phone",name:"phone",value:i.phone,onChange:S,disabled:!t})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"address",children:"Business Address"}),c.jsx("textarea",{id:"address",name:"address",value:i.address,onChange:S,rows:"3",disabled:!t})]}),t&&f&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Change Password"}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"currentPassword",children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:i.currentPassword,onChange:S})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"newPassword",children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:i.newPassword,onChange:S,minLength:"6"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"confirmPassword",children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:i.confirmPassword,onChange:S,minLength:"6"})]})]}),c.jsx("div",{className:"profile-actions",children:t?c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"submit",className:"save-button",disabled:d,children:d?"Saving...":"Save Changes"}),c.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{l(!1),b(!1),n({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",companyName:(null==e?void 0:e.companyName)||"",phone:(null==e?void 0:e.phone)||"",address:(null==e?void 0:e.address)||"",currentPassword:"",newPassword:"",confirmPassword:""})},children:"Cancel"}),!f&&c.jsx("button",{type:"button",className:"password-button",onClick:()=>b(!0),children:"Change Password"})]}):c.jsx(c.Fragment,{children:c.jsx("button",{type:"button",className:"edit-button",onClick:()=>l(!0),children:"Edit Profile"})})})]})]})},E=({onSuccess:i,isEditing:n=!1,packageData:t=null})=>{const{packageId:d}=f(),o=b(),[m,h]=v.useState({title:"",description:"",destination:"",duration:"",price:"",included:["","",""],available:!0,featured:!1}),[u,g]=v.useState([{title:"Day 1",description:""}]),[j,N]=v.useState([]),[k,y]=v.useState(!!n),[w,P]=v.useState(!1),[C,S]=v.useState(null),[F,I]=v.useState(null),[D,A]=v.useState([]);v.useEffect((()=>{n&&d?$():t&&U(t)}),[n,d,t]);const $=async()=>{try{y(!0),S(null);const e=a(s,`tourPackages/${d}`),i=await l(e);if(!i.exists())throw new Error("Package not found");const n=i.val();U(n)}catch(e){S("Failed to fetch package details for editing")}finally{y(!1)}},U=e=>{var a,s;h({title:e.title||"",description:e.description||"",destination:e.destination||"",duration:e.duration||"",price:e.price||"",included:(null==(a=e.included)?void 0:a.length)>0?e.included:["","",""],available:void 0===e.available||e.available,featured:e.featured||!1}),g((null==(s=e.itinerary)?void 0:s.length)>0?e.itinerary:[{title:"Day 1",description:""}]),e.images&&e.images.length>0&&A(e.images.map((e=>({url:e.startsWith("http")?e:"https://source.unsplash.com/random/800x600/?travel",name:"string"==typeof e?e.split("/").pop():"image",isExisting:!0}))))},E=e=>{const{name:a,value:s,type:i,checked:n}=e.target;h({...m,[a]:"checkbox"===i?n:s})},L=(e,a,s)=>{const i=[...u];i[e]={...i[e],[a]:s},g(i)};return k?c.jsx("div",{className:"package-form-loading",children:"Loading package data..."}):c.jsxs("div",{className:"package-form-container",children:[c.jsx("h2",{children:n?"Edit Tour Package":"Create New Tour Package"}),c.jsxs("p",{className:"form-subtitle",children:["Fill in the details below to ",n?"update your":"create a new"," tour package"]}),C&&c.jsxs("div",{className:"form-error",children:[c.jsx("i",{className:"fas fa-exclamation-circle"})," ",C]}),F&&c.jsxs("div",{className:"form-success",children:[c.jsx("i",{className:"fas fa-check-circle"})," ",F]}),c.jsxs("form",{onSubmit:async t=>{var c,d;t.preventDefault(),P(!0),S(null),I(null);try{const t=e.currentUser,c=localStorage.getItem("vendorInfo");if(!t||!c)return S("Authentication required"),void P(!1);const d=a(s,`vendors/${t.uid}`);if(!(await l(d)).exists())return S("Vendor authentication required"),void P(!1);const o=new FormData;o.append("title",m.title),o.append("description",m.description),o.append("destination",m.destination),o.append("duration",m.duration),o.append("price",m.price),o.append("available",m.available),o.append("featured",m.featured);const h=m.included.filter((e=>""!==e.trim()));o.append("included",JSON.stringify(h));const g=u.filter((e=>""!==e.description.trim()));o.append("itinerary",JSON.stringify(g));const v=D.filter((e=>e.isExisting)).map((e=>e.name));o.append("existingImages",JSON.stringify(v)),j.forEach((e=>{o.append("images",e)}));const N={title:m.title,description:m.description,destination:m.destination,duration:m.duration,price:parseFloat(m.price),included:h,itinerary:g,available:m.available,featured:m.featured,vendorId:t.uid,createdAt:Date.now(),updatedAt:Date.now()};let f,b;if(n){const e=a(s,`tourPackages/${f}`);await r(e,{...N,updatedAt:Date.now()}),b={data:{...N,id:f}},I("Package updated successfully")}else{const e=a(s,"tourPackages"),i=p(e);f=i.key,await x(i,N),b={data:{...N,id:f}},I("New package created successfully")}i&&setTimeout((()=>{i(b.data)}),1500)}catch(o){S((null==(d=null==(c=o.response)?void 0:c.data)?void 0:d.message)||"Failed to save package. Please try again.")}finally{P(!1)}},className:"package-form",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"title",children:"Package Title*"}),c.jsx("input",{type:"text",id:"title",name:"title",value:m.title,onChange:E,placeholder:"Enter an attractive package title",required:!0})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"description",children:"Description*"}),c.jsx("textarea",{id:"description",name:"description",value:m.description,onChange:E,rows:"4",placeholder:"Provide a detailed description of the package, including highlights and unique experiences",required:!0}),c.jsx("small",{className:"form-hint",children:"A compelling description helps travelers understand what makes this package special"})]}),c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"Package Details"}),c.jsxs("div",{className:"form-row",children:[c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"destination",children:"Destination*"}),c.jsx("input",{type:"text",id:"destination",name:"destination",value:m.destination,onChange:E,placeholder:"e.g. Kerala, Goa, Rajasthan",required:!0}),c.jsx("small",{className:"form-hint",children:"Popular destination name that travelers will search for"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"duration",children:"Duration*"}),c.jsx("input",{type:"text",id:"duration",name:"duration",value:m.duration,onChange:E,placeholder:"e.g. 3 Days / 2 Nights",required:!0}),c.jsx("small",{className:"form-hint",children:"Format as 'X Days / Y Nights'"})]}),c.jsxs("div",{className:"form-group",children:[c.jsx("label",{htmlFor:"price",children:"Price (₹)*"}),c.jsxs("div",{className:"price-input-wrapper",children:[c.jsx("span",{className:"price-currency",children:"₹"}),c.jsx("input",{type:"number",id:"price",name:"price",value:m.price,onChange:E,min:"0",placeholder:"e.g. 15000",required:!0})]}),c.jsx("small",{className:"form-hint",children:"Price per person in Indian Rupees"})]})]})]}),c.jsxs("div",{className:"form-row checkbox-row",children:[c.jsxs("div",{className:"form-group checkbox-group",children:[c.jsx("input",{type:"checkbox",id:"available",name:"available",checked:m.available,onChange:E}),c.jsx("label",{htmlFor:"available",children:"Available for Booking"}),c.jsx("small",{className:"checkbox-hint",children:"Uncheck to hide this package from search results"})]}),c.jsxs("div",{className:"form-group checkbox-group",children:[c.jsx("input",{type:"checkbox",id:"featured",name:"featured",checked:m.featured,onChange:E}),c.jsx("label",{htmlFor:"featured",children:"Featured Package"}),c.jsx("small",{className:"checkbox-hint",children:"Featured packages appear on the homepage"})]})]}),c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"What's Included"}),c.jsx("p",{className:"section-description",children:"List the amenities, services, and experiences included in this package"}),c.jsx("div",{className:"included-items-container",children:m.included.map(((e,a)=>c.jsxs("div",{className:"included-item",children:[c.jsx("div",{className:"included-item-icon",children:c.jsx("i",{className:"fas fa-check-circle"})}),c.jsx("input",{type:"text",value:e,onChange:e=>((e,a)=>{const s=[...m.included];s[e]=a,h({...m,included:s})})(a,e.target.value),placeholder:"e.g. Accommodation, Meals, Transportation, etc."}),c.jsx("button",{type:"button",className:"remove-button",onClick:()=>(e=>{const a=[...m.included];a.splice(e,1),h({...m,included:a})})(a),"aria-label":"Remove item",children:c.jsx("i",{className:"fas fa-times"})})]},`included-${a}`)))}),c.jsxs("button",{type:"button",className:"add-button",onClick:()=>{h({...m,included:[...m.included,""]})},children:[c.jsx("i",{className:"fas fa-plus"})," Add Item"]})]}),c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"Itinerary Details"}),c.jsx("p",{className:"section-description",children:"Create a day-by-day breakdown of activities and experiences"}),c.jsx("div",{className:"itinerary-container",children:u.map(((e,a)=>c.jsxs("div",{className:"itinerary-item",children:[c.jsx("div",{className:"itinerary-day-number",children:a+1}),c.jsxs("div",{className:"itinerary-content",children:[c.jsxs("div",{className:"itinerary-header",children:[c.jsx("input",{type:"text",value:e.title,onChange:e=>L(a,"title",e.target.value),placeholder:`Day ${a+1}`,className:"itinerary-day-title"}),c.jsx("button",{type:"button",className:"remove-button small",onClick:()=>(e=>{const a=[...u];a.splice(e,1);const s=a.map(((e,a)=>({...e,title:e.title.startsWith("Day ")?`Day ${a+1}`:e.title})));g(s)})(a),"aria-label":"Remove day",children:c.jsx("i",{className:"fas fa-trash-alt"})})]}),c.jsx("textarea",{value:e.description,onChange:e=>L(a,"description",e.target.value),placeholder:"Describe the activities, meals, accommodations, and highlights for this day in detail",rows:"3",className:"itinerary-description"})]})]},`itinerary-${a}`)))}),c.jsxs("button",{type:"button",className:"add-button",onClick:()=>{g([...u,{title:`Day ${u.length+1}`,description:""}])},children:[c.jsx("i",{className:"fas fa-calendar-plus"})," Add Another Day"]})]}),c.jsxs("div",{className:"form-section",children:[c.jsx("h3",{children:"Package Images"}),c.jsx("p",{className:"section-description",children:"Upload high-quality images that showcase the destination and experiences"}),c.jsxs("div",{className:"image-upload-container",children:[c.jsxs("div",{className:"image-upload-input",children:[c.jsx("input",{type:"file",id:"images",name:"images",onChange:e=>{const a=Array.from(e.target.files);N([...j,...a]);const s=a.map((e=>({url:URL.createObjectURL(e),name:e.name,isExisting:!1})));A([...D,...s])},multiple:!0,accept:"image/*",className:"file-input"}),c.jsxs("label",{htmlFor:"images",className:"custom-file-upload",children:[c.jsx("i",{className:"fas fa-cloud-upload-alt"})," Select Images"]}),c.jsx("small",{className:"form-hint",children:"You can select multiple images at once"})]}),D.length>0&&c.jsx("div",{className:"image-preview-grid",children:D.map(((e,a)=>c.jsxs("div",{className:"image-preview-item",children:[c.jsx("img",{src:e.url,alt:`Preview ${a+1}`}),c.jsx("button",{type:"button",className:"image-preview-remove",onClick:()=>(e=>{const a=[...j],s=[...D];if(!s[e].isExisting){const i=j.findIndex((a=>a.name===s[e].name));-1!==i&&a.splice(i,1)}s.splice(e,1),N(a),A(s)})(a),"aria-label":"Remove image",children:c.jsx("i",{className:"fas fa-times"})}),c.jsx("div",{className:"image-preview-info",children:c.jsxs("span",{className:"image-name",children:[e.isExisting?"Existing: ":"",e.name.length>15?`${e.name.substring(0,15)}...`:e.name]})})]},`image-${a}`)))})]})]}),c.jsxs("div",{className:"form-buttons",children:[c.jsxs("button",{type:"button",className:"cancel-button",onClick:()=>{i?i():o(-1)},children:[c.jsx("i",{className:"fas fa-times"})," Cancel"]}),c.jsx("button",{type:"submit",className:"submit-button",disabled:w,children:w?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading-spinner"}),n?"Updating...":"Creating..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-save"})," ",n?"Update Package":"Create Package"]})})]})]})]})},L=()=>{const[i,n]=v.useState("packages"),[t,r]=v.useState(!0),[d,o]=v.useState(null),[m,h]=v.useState(null),[u,p]=v.useState(!1),x=b();v.useEffect((()=>{r(!0);const i=g(e,(async i=>{if(!i)return x("/vendor/login"),void r(!1);try{const n=a(s,`vendors/${i.uid}`),t=await l(n);if(!t.exists())return o("This account is not registered as a vendor. Please use the customer login."),await j(e),void x("/vendor/login");const c=t.val(),r=a(s,`earnings/${i.uid}`),d=await l(r),m=d.exists()?d.val():{total:0},u={...c,earnings:"number"==typeof m?m:m.total||0};h(u),localStorage.setItem("vendorInfo",JSON.stringify(u))}catch(n){o("Failed to load vendor profile. Please try logging in again.")}finally{r(!1)}}));return()=>i()}),[x]);if(t)return c.jsxs("div",{className:"loading-spinner-container",children:[c.jsx("div",{className:"loading-spinner"}),c.jsx("p",{children:"Loading dashboard..."})]});if(d)return c.jsx("div",{className:"error-container",children:c.jsx("div",{className:"alert alert-danger",children:d})});const N=[{title:"Earnings",value:`₹${Math.floor((null==m?void 0:m.earnings)||0).toLocaleString("en-IN")}`,icon:"rupee",color:"warning",description:"Total revenue from bookings"}];return c.jsxs("div",{className:"vendor-dashboard-container",children:[c.jsxs("aside",{className:"vendor-sidebar",children:[c.jsxs("div",{className:"sidebar-header",children:[c.jsx("h2",{children:"Travelita"}),c.jsx("p",{children:"Vendor Portal"})]}),c.jsxs("nav",{className:"sidebar-nav",children:[c.jsx("div",{className:"nav-item",children:c.jsxs("a",{href:"#",className:"nav-link "+("packages"===i?"active":""),onClick:e=>{e.preventDefault(),n("packages"),p(!1)},children:[c.jsx("span",{})," Tour Packages"]})}),c.jsx("div",{className:"nav-item",children:c.jsxs("a",{href:"#",className:"nav-link "+("bookings"===i?"active":""),onClick:e=>{e.preventDefault(),n("bookings"),p(!1)},children:[c.jsx("span",{})," Bookings"]})}),c.jsx("div",{className:"nav-item",children:c.jsxs("a",{href:"#",className:"nav-link "+("profile"===i?"active":""),onClick:e=>{e.preventDefault(),n("profile"),p(!1)},children:[c.jsx("span",{})," Profile"]})})]}),c.jsx("div",{className:"sidebar-footer",children:c.jsxs("button",{className:"btn btn-block btn-outline",onClick:async()=>{try{await j(e),localStorage.removeItem("vendorInfo"),x("/vendor/login")}catch(a){o("Failed to log out. Please try again.")}},children:[c.jsx("span",{})," Logout"]})})]}),c.jsxs("main",{className:"vendor-main-content",children:[c.jsx("header",{className:"dashboard-header",children:c.jsx("div",{className:"dashboard-header-content",children:c.jsxs("div",{className:"welcome-section",children:[c.jsxs("h1",{children:["Welcome back, ",(null==m?void 0:m.name)||"Vendor","! 👋"]}),c.jsx("p",{children:"Here's what's happening with your tour business today"})]})})}),c.jsx("div",{className:"quick-stats",children:N.map(((e,a)=>c.jsxs("div",{className:"stat-card",children:[c.jsx("div",{className:"stat-icon",style:{background:`var(--${e.color}-100)`,color:`var(--${e.color}-600)`},children:e.icon}),c.jsxs("div",{className:"stat-content",children:[c.jsx("h3",{children:e.value}),c.jsx("p",{children:e.title})]})]},a)))}),c.jsxs("div",{className:"content-body",children:["packages"===i&&!u&&c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"card-header",children:[c.jsx("h2",{className:"card-title",children:"My Tour Packages"}),c.jsx("button",{className:"btn btn-primary",onClick:()=>p(!0),children:"+ Add New Package"})]}),c.jsx("div",{className:"card-body",children:c.jsx(A,{})})]}),"packages"===i&&u&&c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"card-header",children:[c.jsx("h2",{className:"card-title",children:"Add New Package"}),c.jsx("button",{className:"btn btn-outline",onClick:()=>p(!1),children:"← Back to Packages"})]}),c.jsx("div",{className:"card-body",children:c.jsx(E,{onSuccess:()=>p(!1)})})]}),"bookings"===i&&c.jsx("div",{className:"card",children:c.jsx("div",{className:"card-body",children:c.jsx($,{})})}),"profile"===i&&c.jsx("div",{className:"card",children:c.jsx("div",{className:"card-body",children:c.jsx(U,{vendorInfo:m})})})]})]})]})};export{L as default};
