import{j as e,c as a,d as s,g as t,f as n}from"./index-jW0ZXYkQ.js";import{u as r,r as i,L as c}from"./router-CE_eIJm-.js";/* empty css                   */import"./react-CMmhtoO5.js";function o(){const o=r(),[l,d]=i.useState("dashboard"),[h,m]=i.useState({totalUsers:0,totalVendors:0,totalPackages:0,totalBookings:0,pendingApprovals:0,recentPackages:[],recentBookings:[],packagesByDestination:{},bookingsByMonth:{}}),[g,p]=i.useState([]),[x,v]=i.useState([]),[j,k]=i.useState([]),[u,N]=i.useState([]),[w,b]=i.useState(!0),[M,L]=i.useState(null),[f,B]=i.useState(!1),[C,S]=i.useState(""),[V,y]=i.useState(!1),[A,P]=i.useState(""),[D,W]=i.useState("all");i.useEffect((()=>{(async()=>{try{b(!0);const n=JSON.parse(localStorage.getItem("user"));if(!n||"admin"!==n.role)return L("Admin authentication required"),b(!1),void o("/login");try{const e=a(s,"users"),n=await t(e),r=n.exists()?Object.entries(n.val()).map((([e,a])=>({id:e,...a}))):[],i=r.filter((e=>"user"===e.role)),c=r.filter((e=>"vendor"===e.role));k(i),N(c);const o=a(s,"tourPackages"),l=await t(o),d=l.exists()?Object.entries(l.val()).map((([e,a])=>({id:e,...a,createdAt:a.createdAt||Date.now()}))):[];v(d);const h=d.filter((e=>"pending"===e.status||!e.status));p(h);const g=a(s,"bookings"),x=await t(g),j=x.exists()?Object.entries(x.val()).map((([e,a])=>({id:e,...a,createdAt:a.createdAt||Date.now()}))):[],u=[...d].sort(((e,a)=>(a.createdAt||0)-(e.createdAt||0))).slice(0,5),w=[...j].sort(((e,a)=>(a.createdAt||0)-(e.createdAt||0))).slice(0,5),b=d.reduce(((e,a)=>{const s=a.destination||"Other";return e[s]||(e[s]=0),e[s]++,e}),{}),M=j.reduce(((e,a)=>{let s;try{s=new Date(a.createdAt),isNaN(s.getTime())&&(s=new Date)}catch(n){s=new Date}const t=s.toLocaleString("default",{month:"short"});return e[t]||(e[t]=0),e[t]++,e}),{});m({totalUsers:i.length,totalVendors:c.length,totalPackages:d.length,totalBookings:j.length,pendingApprovals:h.length,recentPackages:u,recentBookings:w,packagesByDestination:b,bookingsByMonth:M})}catch(e){m({totalUsers:0,totalVendors:0,totalPackages:0,totalBookings:0,pendingApprovals:0,recentPackages:[],recentBookings:[],packagesByDestination:{},bookingsByMonth:{}})}b(!1)}catch(n){L("Failed to fetch admin data. Please try again."),b(!1)}})()}),[o]);const z=e=>{d(e)};x.filter((e=>{var a,s;const t=(null==(a=e.title)?void 0:a.toLowerCase().includes(A.toLowerCase()))||(null==(s=e.destination)?void 0:s.toLowerCase().includes(A.toLowerCase()));return"all"===D?t:t&&e.status===D}));const O=async(e,r)=>{try{B(!0);const i=JSON.parse(localStorage.getItem("user")),c=a(s,`tourPackages/${e}`),o=await t(c);if(!o.exists())throw new Error("Package not found");o.val();"approve"===r?await n(c,{status:"approved",approvedAt:Date.now(),approvedBy:i.id}):"reject"===r&&await n(c,{status:"rejected",rejectedAt:Date.now(),rejectedBy:i.id}),p(g.filter((a=>a.id!==e))),m({...h,pendingApprovals:h.pendingApprovals-1,totalPackages:"approve"===r?h.totalPackages+1:h.totalPackages});const l=document.createElement("div");l.className="success-toast",l.textContent=`Package ${"approve"===r?"approved":"rejected"} successfully`,document.body.appendChild(l),setTimeout((()=>{l.remove()}),3e3),B(!1)}catch(i){let e=`Failed to ${r} package. Please try again.`;const a=document.createElement("div");a.className="error-toast",a.textContent=e,document.body.appendChild(a),setTimeout((()=>{a.remove()}),5e3),B(!1)}};return w?e.jsx("div",{className:"loading-container",children:e.jsx("div",{className:"loading-spinner"})}):M?e.jsx("div",{className:"error-container",children:e.jsxs("div",{className:"error-box",children:[e.jsx("h2",{className:"error-title",children:"Error"}),e.jsx("p",{className:"error-text",children:M}),e.jsx("button",{onClick:()=>window.location.reload(),className:"error-button",children:"Try Again"})]})}):e.jsx("div",{className:"admin-dashboard",children:e.jsxs("div",{className:"admin-container",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{className:"admin-title",children:"Admin Dashboard"}),e.jsx("p",{className:"admin-subtitle",children:"Manage your tour package platform and monitor system performance"}),e.jsxs("div",{className:"admin-tabs",children:[e.jsxs("button",{className:"admin-tab "+("dashboard"===l?"active":""),onClick:()=>z("dashboard"),children:[e.jsx("span",{className:"tab-icon",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),"Dashboard"]}),e.jsxs("button",{className:"admin-tab "+("packages"===l?"active":""),onClick:()=>z("packages"),children:[e.jsx("span",{className:"tab-icon",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),"Packages",g.length>0&&e.jsx("span",{className:"notification-badge",children:g.length})]}),e.jsxs("button",{className:"admin-tab "+("bookings"===l?"active":""),onClick:()=>z("bookings"),children:[e.jsx("span",{className:"tab-icon",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),"Bookings"]}),e.jsxs("button",{className:"admin-tab "+("users"===l?"active":""),onClick:()=>z("users"),children:[e.jsx("span",{className:"tab-icon",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),"Users"]}),e.jsxs(c,{to:"/admin/bookings",className:"admin-tab",children:[e.jsx("span",{className:"tab-icon",children:e.jsxs("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),"Bookings Management"]})]})]}),"dashboard"===l&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"stats-grid",children:[e.jsx("div",{className:"stats-card users-card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-icon blue",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{className:"card-details",children:[e.jsx("h3",{className:"card-title",children:"Total Users"}),e.jsxs("div",{className:"card-stat-row",children:[e.jsx("div",{className:"card-stat-value",children:h.totalUsers}),e.jsx("button",{onClick:()=>z("users"),className:"card-link",children:"View all"})]})]})]})})}),e.jsx("div",{className:"stats-card vendors-card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-icon indigo",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsxs("div",{className:"card-details",children:[e.jsx("h3",{className:"card-title",children:"Vendors"}),e.jsxs("div",{className:"card-stat-row",children:[e.jsx("div",{className:"card-stat-value",children:h.totalVendors}),e.jsx("button",{onClick:()=>z("users"),className:"card-link",children:"View all"})]})]})]})})}),e.jsx("div",{className:"stats-card packages-card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-icon green",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),e.jsxs("div",{className:"card-details",children:[e.jsx("h3",{className:"card-title",children:"Packages"}),e.jsxs("div",{className:"card-stat-row",children:[e.jsx("div",{className:"card-stat-value",children:h.totalPackages}),e.jsx("button",{onClick:()=>z("packages"),className:"card-link",children:"View all"})]})]})]})})}),e.jsx("div",{className:"stats-card bookings-card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"card-inner",children:[e.jsx("div",{className:"card-icon yellow",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),e.jsxs("div",{className:"card-details",children:[e.jsx("h3",{className:"card-title",children:"Bookings"}),e.jsxs("div",{className:"card-stat-row",children:[e.jsx("div",{className:"card-stat-value",children:h.totalBookings}),e.jsx(c,{to:"/admin/bookings",className:"card-link",children:"View all"})]})]})]})})})]})}),e.jsxs("div",{className:"admin-section",children:[e.jsxs("div",{className:"admin-section-header",children:[e.jsx("h2",{className:"section-title",children:"Pending Package Approvals"}),e.jsx("span",{className:"badge badge-pending",children:h.pendingApprovals})]}),0===g.length?e.jsx("div",{className:"section-box empty-message",children:e.jsx("p",{className:"empty-text",children:"No packages pending approval at this time."})}):e.jsx("div",{className:"section-box",children:e.jsx("ul",{className:"package-list",children:g.map(((a,s)=>{var t;return e.jsx("li",{className:"package-card",children:e.jsxs("div",{className:"package-row",children:[e.jsxs("div",{className:"package-content",children:[e.jsx("div",{className:"package-image",children:e.jsx("img",{src:a.images&&a.images.length>0&&a.images[0].startsWith("http")?a.images[0]:"https://source.unsplash.com/random/300x200/?travel",alt:a.title,onError:e=>{e.target.onerror=null,e.target.src="https://source.unsplash.com/random/300x200/?travel"}})}),e.jsxs("div",{className:"package-details",children:[e.jsx("h3",{className:"package-title",children:a.title}),e.jsxs("div",{className:"package-info",children:[e.jsxs("span",{className:"package-meta",children:["Vendor: ",(null==(t=a.vendor)?void 0:t.name)||"Unknown"]}),e.jsx("span",{className:"package-divider",children:"•"}),e.jsxs("span",{className:"package-meta",children:["Price: ₹",a.price]}),e.jsx("span",{className:"package-divider",children:"•"}),e.jsx("span",{className:"package-meta",children:a.duration}),e.jsx("span",{className:"package-divider",children:"•"}),e.jsxs("span",{className:"package-meta",children:["Destination: ",a.destination]})]}),e.jsx("p",{className:"package-description",children:a.description})]})]}),e.jsxs("div",{className:"action-buttons",children:[e.jsxs(c,{to:`/packages/${a.id}`,target:"_blank",rel:"noopener noreferrer",className:"action-button view",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View"]}),e.jsxs("button",{onClick:()=>O(a.id,"approve"),disabled:f,className:"action-button approve",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]}),e.jsxs("button",{onClick:()=>O(a.id,"reject"),disabled:f,className:"action-button reject",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Reject"]})]})]})},a.id||a._id||`pending-package-${s}`)}))})})]}),e.jsxs("div",{className:"admin-section",children:[e.jsx("div",{className:"admin-section-header",children:e.jsx("h2",{className:"section-title",children:"Recent Packages"})}),e.jsx("div",{className:"section-box",children:h.recentPackages&&h.recentPackages.length>0?e.jsx("ul",{className:"package-list",children:h.recentPackages.map(((a,s)=>e.jsx("li",{className:"package-card",children:e.jsxs("div",{className:"package-content",children:[e.jsx("div",{className:"package-image",children:e.jsx("img",{src:a.images&&a.images.length>0&&a.images[0].startsWith("http")?a.images[0]:"https://source.unsplash.com/random/300x200/?travel",alt:a.title,onError:e=>{e.target.onerror=null,e.target.src="https://source.unsplash.com/random/300x200/?travel"}})}),e.jsxs("div",{className:"package-details",children:[e.jsx(c,{to:`/packages/${a._id}`,className:"package-title-link",children:a.title}),e.jsxs("div",{className:"package-info",children:[e.jsxs("span",{className:"package-meta",children:["Status:",e.jsx("span",{className:"badge "+("approved"===a.status?"badge-approved":"pending"===a.status?"badge-pending":"badge-rejected"),children:a.status})]}),e.jsx("span",{className:"package-divider",children:"•"}),e.jsxs("span",{className:"package-meta",children:["Added: ",new Date(a.createdAt).toLocaleDateString()]})]})]})]})},a.id||a._id||`recent-package-${s}`)))}):e.jsx("div",{className:"empty-message",children:e.jsx("p",{className:"empty-text",children:"No recent packages available."})})})]}),e.jsxs("div",{className:"nav-grid",children:[e.jsx(c,{to:"/admin/users",className:"nav-card",children:e.jsxs("div",{className:"nav-card-content",children:[e.jsx("div",{className:"nav-icon purple",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsxs("div",{className:"nav-details",children:[e.jsx("h3",{className:"nav-title",children:"Manage Users"}),e.jsx("p",{className:"nav-desc",children:"View and manage user accounts and permissions"})]})]})}),e.jsx(c,{to:"/admin/packages",className:"nav-card",children:e.jsxs("div",{className:"nav-card-content",children:[e.jsx("div",{className:"nav-icon blue",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{className:"nav-details",children:[e.jsx("h3",{className:"nav-title",children:"Manage Packages"}),e.jsx("p",{className:"nav-desc",children:"View, edit, and delete tour packages"})]})]})}),e.jsx(c,{to:"/admin/bookings",className:"nav-card",children:e.jsxs("div",{className:"nav-card-content",children:[e.jsx("div",{className:"nav-icon green",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),e.jsxs("div",{className:"nav-details",children:[e.jsx("h3",{className:"nav-title",children:"Manage Bookings"}),e.jsx("p",{className:"nav-desc",children:"View and manage all customer bookings"})]})]})})]})]})})}(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString();export{o as default};
