import{u as e,b as a,j as s}from"./index-CTnmfCPK.js";import{b as i,r,u as t}from"./router-CbvfO1vz.js";import"./react-CMmhtoO5.js";const n=()=>s.jsx("span",{className:"icon-style",children:"ðŸ“"}),c=()=>s.jsx("span",{className:"icon-style",children:"ðŸ•’"}),l=()=>{const{packageId:l}=i(),[o,d]=r.useState(null),[h,m]=r.useState(!0),[g,u]=r.useState(null),[p,x]=r.useState(0),[j,k]=r.useState(!1),[v,N]=r.useState(null),[b,f]=r.useState(!1),y=t(),{currentUser:S}=e(),{getPackageById:w,createBooking:E}=a(),I=r.useCallback((async()=>{if(l)try{m(!0),u(null);const e=await w(l);if(!e)throw new Error("Package not found");d(e)}catch(e){u(e.message||"Failed to fetch package")}finally{m(!1)}}),[l,w]),B=r.useRef(!1);if(r.useEffect((()=>{l&&!B.current&&(B.current=!0,I())}),[l,I]),h)return s.jsx("div",{className:"package-details-loading",children:s.jsx("div",{className:"spinner"})});if(g)return s.jsxs("div",{className:"container package-details-error",children:["Error: ",g]});if(!o)return s.jsx("div",{className:"container package-details-error",children:"Package not found."});const{title:P,description:D,destination:W,duration:C,price:$,images:F=[],included:T=[],itinerary:z=[],available:L}=o,R=F.map((e=>e.startsWith("http://")||e.startsWith("https://")?e:"https://source.unsplash.com/random/800x600/?travel,destination")),U=R.length>0?R[p]:"https://source.unsplash.com/random/800x600/?travel",Y=!1!==L;return s.jsx("div",{className:"container package-details-container",children:s.jsxs("div",{className:"package-details-content",children:[s.jsxs("div",{className:"package-gallery",children:[s.jsx("div",{className:"main-image",children:s.jsx("img",{src:U,alt:P,onError:e=>{e.target.onerror=null,e.target.src="https://source.unsplash.com/random/800x600/?travel"}})}),R.length>1&&s.jsx("div",{className:"image-thumbnails",children:R.map(((e,a)=>s.jsx("div",{className:"thumbnail "+(p===a?"active":""),onClick:()=>x(a),children:s.jsx("img",{src:e,alt:`${P} - Image ${a+1}`,onError:e=>{e.target.onerror=null,e.target.src="https://source.unsplash.com/random/150x150/?travel"}})},a)))})]}),s.jsxs("div",{className:"package-info",children:[s.jsx("h1",{children:P}),s.jsxs("div",{className:"package-meta",children:[s.jsxs("p",{children:[s.jsx(n,{})," ",s.jsx("strong",{children:"Destination:"})," ",W]}),s.jsxs("p",{children:[s.jsx(c,{})," ",s.jsx("strong",{children:"Duration:"})," ",C]}),s.jsxs("p",{className:"package-price-tag",style:{fontSize:"1.5rem",color:"var(--secondary-color)",fontWeight:"bold",marginTop:"1rem"},children:["Price: â‚¹",$.toLocaleString()]})]}),s.jsx("p",{className:"description",children:D}),s.jsx("div",{className:"package-booking-section",children:Y?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{const e={id:l,title:o.title,description:o.description,destination:o.destination,duration:o.duration,price:o.price,images:o.images||[],included:o.included||[],itinerary:o.itinerary||[],available:o.available,packageId:l};y(`/book/${l}`,{state:{packageData:e}})},disabled:j||b,className:"book-now-button",children:j?"Processing...":b?"Booked!":"Book Now"}),v&&s.jsxs("p",{className:"booking-error-message",children:["Error: ",v]}),b&&s.jsx("p",{className:"booking-success-message",children:"Booking successful! You will be contacted shortly."})]}):s.jsx("p",{className:"package-unavailable-message",children:"This package is currently unavailable for booking."})}),T.length>0&&s.jsxs("div",{className:"package-section included-items",children:[s.jsx("h3",{children:"What's Included:"}),s.jsx("ul",{children:T.map(((e,a)=>s.jsx("li",{children:e},a)))})]}),z.length>0&&s.jsxs("div",{className:"package-section itinerary",children:[s.jsx("h3",{children:"Itinerary:"}),z.map(((e,a)=>s.jsxs("div",{className:"itinerary-day",children:[s.jsxs("h4",{children:["Day ",a+1,": ",e.title]}),s.jsx("p",{children:e.description})]},a)))]})]})]})})};export{l as default};
