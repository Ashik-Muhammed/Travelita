import{j as e,t as s}from"./index-YV7c_xAD.js";import{r as a}from"./router-CbvfO1vz.js";import"./react-CMmhtoO5.js";const l=()=>{const[l,t]=a.useState([]),[i,r]=a.useState(!0),[d,n]=a.useState(""),[c,o]=a.useState(""),[m,u]=a.useState(null),[h,j]=a.useState({displayName:"",email:"",role:"user"});a.useEffect((()=>{(async()=>{try{const e=await s.get("users"),a=Object.entries(e||{}).map((([e,s])=>({id:e,...s})));t(a)}catch(e){n("Failed to load users. Please refresh the page.")}finally{r(!1)}})()}),[]);const x=e=>{const{name:s,value:a}=e.target;j((e=>({...e,[s]:a})))},N=l.filter((e=>e.email&&e.email.toLowerCase().includes(c)||e.displayName&&e.displayName.toLowerCase().includes(c)));return i?e.jsx("div",{className:"admin-users",children:"Loading users..."}):d?e.jsx("div",{className:"error-message",children:d}):e.jsxs("div",{className:"admin-users",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h2",{children:"Manage Users"}),e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:c,onChange:e=>{o(e.target.value.toLowerCase())}}),e.jsx("i",{className:"fas fa-search"})]})]}),0===N.length?e.jsx("div",{className:"no-results",children:"No users found"}):e.jsx("div",{className:"users-table-container",children:e.jsxs("table",{className:"users-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:N.map((a=>e.jsxs("tr",{children:[e.jsx("td",{children:m===a.id?e.jsx("input",{type:"text",name:"displayName",value:h.displayName,onChange:x,className:"edit-input"}):a.displayName||"N/A"}),e.jsx("td",{children:a.email||"N/A"}),e.jsx("td",{children:m===a.id?e.jsxs("select",{name:"role",value:h.role,onChange:x,className:"edit-select",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"vendor",children:"Vendor"})]}):e.jsx("span",{className:`role-badge ${a.role||"user"}`,children:a.role||"user"})}),e.jsx("td",{children:a.createdAt?new Date(a.createdAt).toLocaleDateString():"N/A"}),e.jsx("td",{className:"actions",children:m===a.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"save-btn",onClick:()=>(async e=>{try{await s.update(`users/${e}`,{displayName:h.displayName,role:h.role}),t(l.map((s=>s.id===e?{...s,...h}:s))),u(null)}catch(a){n("Failed to update user")}})(a.id),children:"Save"}),e.jsx("button",{className:"cancel-btn",onClick:()=>u(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"edit-btn",onClick:()=>(e=>{u(e.id),j({displayName:e.displayName||"",email:e.email||"",role:e.role||"user"})})(a),title:"Edit user",children:[e.jsx("i",{className:"fas fa-edit"})," Edit"]}),e.jsxs("button",{className:"delete-btn",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{await s.remove(`users/${e}`),t(l.filter((s=>s.id!==e)))}catch(a){n("Failed to delete user")}})(a.id),disabled:"admin"===a.role,title:"admin"===a.role?"Cannot delete admin users":"Delete user",children:[e.jsx("i",{className:"fas fa-trash"})," Delete"]})]})})]},a.id)))})]})})]})};export{l as default};
