import{j as s,v as e,w as a,k as t}from"./index-C_BwQPEG.js";import{r as i}from"./router-CLN5X-po.js";import"./react-CMmhtoO5.js";const r=()=>{const[r,d]=i.useState({totalUsers:0,activeUsers:0,totalBookings:0,totalPackages:0,recentBookings:[],loading:!0,error:null});return i.useEffect((()=>{let s=!0;const i=async()=>{try{const e=await t.get("users")||{},a=Object.keys(e).length,i=await t.get("bookings")||{},r=Object.keys(i).length,l=Object.entries(i).slice(-5).map((([s,e])=>({id:s,...e,date:new Date(e.createdAt).toLocaleDateString()}))).reverse(),c=await t.get("packages")||{},n=Object.keys(c).length,o=Date.now()-2592e6,h=Object.values(e).filter((s=>s.lastLogin&&s.lastLogin>o)).length;s&&d({totalUsers:a,activeUsers:h,totalBookings:r,totalPackages:n,recentBookings:l,loading:!1,error:null})}catch(e){s&&d((s=>({...s,loading:!1,error:e.message||"Failed to load dashboard data. Please try again later."})))}};return(async()=>{try{if(e()||await a(),!e())throw new Error("Failed to initialize Firebase");await i()}catch(t){s&&d((s=>({...s,loading:!1,error:"Failed to initialize database. Please refresh the page."})))}})(),()=>{s=!1}}),[]),r.loading?s.jsx("div",{className:"admin-dashboard",children:s.jsx("h2",{children:"Loading dashboard..."})}):r.error?s.jsx("div",{className:"admin-dashboard",children:s.jsx("div",{className:"error-message",children:r.error})}):s.jsxs("div",{className:"admin-dashboard",children:[s.jsx("h2",{children:"Dashboard Overview"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("h3",{children:"Total Users"}),s.jsx("div",{className:"stat-value",children:r.totalUsers}),s.jsx("div",{className:"stat-icon",children:"👥"})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("h3",{children:"Active Users"}),s.jsx("div",{className:"stat-value",children:r.activeUsers}),s.jsx("div",{className:"stat-icon",children:"🟢"})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("h3",{children:"Total Bookings"}),s.jsx("div",{className:"stat-value",children:r.totalBookings}),s.jsx("div",{className:"stat-icon",children:"📅"})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("h3",{children:"Tour Packages"}),s.jsx("div",{className:"stat-value",children:r.totalPackages}),s.jsx("div",{className:"stat-icon",children:"✈️"})]})]}),s.jsxs("div",{className:"recent-activity",children:[s.jsx("h3",{children:"Recent Bookings"}),r.recentBookings.length>0?s.jsx("div",{className:"bookings-table",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Booking ID"}),s.jsx("th",{children:"Package"}),s.jsx("th",{children:"User"}),s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Status"})]})}),s.jsx("tbody",{children:r.recentBookings.map((e=>s.jsxs("tr",{children:[s.jsxs("td",{children:[e.id.substring(0,8),"..."]}),s.jsx("td",{children:e.packageName||"N/A"}),s.jsx("td",{children:e.userName||"Guest"}),s.jsx("td",{children:e.date}),s.jsx("td",{children:s.jsx("span",{className:`status-badge ${e.status||"pending"}`,children:e.status||"Pending"})})]},e.id)))})]})}):s.jsx("p",{children:"No recent bookings found."})]})]})};export{r as default};
